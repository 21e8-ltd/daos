#!python

Import('env', 'PREREQS')

# Generic DAOS includes
env.Append(CPPPATH = ['#/src/include'])

# Generate the common libraries used by everyone
SConscript('common/SConscript', exports=['env', 'PREREQS'])
SConscript('dtp/SConscript', exports=['env', 'PREREQS'])
SConscript('common/SConscript.event', exports='env')

# VOS comes with two flavors
# A standalone library mostly used for testing
srv = False
SConscript('vos/SConscript', exports=['env', 'PREREQS', 'srv'])
srv = True
VariantDir('vos_srv', 'vos', duplicate=0)
SConscript('vos_srv/SConscript', exports=['env', 'PREREQS', 'srv'])

# Then the DAOS server executable
SConscript('server/SConscript', exports=['env', 'PREREQS'])

# Build each DAOS layers
SConscript('dmg/SConscript', exports='env')
SConscript('dsm/SConscript', exports=['env', 'PREREQS'])
SConscript('dsr/SConscript', exports='env')
SConscript('dct/SConscript', exports='env')

# Build utilities
SConscript('utils/SConscript', exports=['env', 'PREREQS'])

# And finally build test
SConscript('tests/SConscript', exports=['env', 'PREREQS'])
